import{j as e}from"./ui-vendor-izRNgCO_.js";import{d as s,r as a}from"./react-vendor-r9Et1EnL.js";import{c as t,e as r,a as i,u as n,m as l,b as c,A as d,f as o,g as m,h as x,C as p,B as h}from"./index-Dpso9GU3.js";import{C as j,a as g,b as u,c as y,d as v}from"./card-Sps0XDlE.js";import{D as N,a as f,b,c as w,f as k,d as q}from"./dialog-CzuAHObH.js";import{T as C}from"./textarea-Bh8QdlON.js";import{L as S}from"./label-BnKDd-HG.js";import{C as R,a as A}from"./circle-x-DHByMjyv.js";import{C as D}from"./circle-alert-BIj8_q8m.js";import"./chart-vendor-D0NPwkge.js";
/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=t("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);function P(){const t=s(),P=r(e=>e.user),[T,E]=a.useState([]),[M,H]=a.useState(!0),[L,$]=a.useState(null),[O,U]=a.useState(!1),[z,Y]=a.useState(null),[B,J]=a.useState(""),[K,V]=a.useState(""),[G,I]=a.useState(!1),Q="http://localhost:5000/api/doctor";a.useEffect(()=>{P&&"DOCTOR"===P.role||t("/auth/login")},[P,t]),a.useEffect(()=>{W()},[]);const W=async()=>{var e;try{H(!0);const e=await i.get(`${Q}/pending-requests`,{withCredentials:!0});e.data.success&&E(e.data.data)}catch(s){i.isAxiosError(s)&&s.response?n.error((null==(e=s.response.data)?void 0:e.message)||"Failed to fetch pending requests"):n.error("Unknown error occurred")}finally{H(!1)}},X=(e,s)=>{$(e),Y(s),U(!0)};return M?e.jsx("div",{className:"p-6 md:p-8",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})})}):e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"Pending Appointment Requests"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-lg",children:"Review and respond to patient appointment requests"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(c,{variant:"secondary",className:"text-sm",children:[T.length," Pending"]})})]})}),e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:T.length>0?e.jsx("div",{className:"space-y-6",children:T.map((s,a)=>e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*a},children:e.jsxs(j,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(d,{className:"w-12 h-12",children:[e.jsx(o,{src:s.patient.profilePicture||"/placeholder.svg"}),e.jsx(m,{children:s.patient.name.split(" ").map(e=>e[0]).join("")})]}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg",children:s.patient.name}),e.jsx(y,{children:s.patient.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"outline",className:"text-xs",children:s.appointmentType}),e.jsx(c,{variant:"secondary",className:"text-xs",children:new Date(s.createdAt).toLocaleDateString()})]})]})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsxs("span",{children:["Date: ",new Date(s.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsxs("span",{children:["Time: ",s.time]})]}),s.consultationFee&&e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300",children:e.jsxs("span",{children:["Fee: â‚¹",s.consultationFee]})})]}),e.jsx("div",{className:"space-y-2",children:s.patient.medicalHistory&&e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 dark:text-white mb-1",children:"Medical History"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:s.patient.medicalHistory})]})})]}),s.notes&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"Patient Notes"]}),e.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.notes})})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(h,{onClick:()=>X(s,"accept"),className:"bg-green-600 hover:bg-green-700 flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Accept Request"]}),e.jsxs(h,{onClick:()=>X(s,"reject"),variant:"destructive",className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Reject Request"]})]})]})]})},s.id))}):e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(D,{className:"h-12 w-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"No Pending Requests"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 max-w-md mx-auto",children:"You don't have any pending appointment requests at the moment. New requests will appear here when patients book appointments."})]})}),e.jsx(N,{open:O,onOpenChange:U,children:e.jsxs(f,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(w,{children:"accept"===z?"Accept Appointment Request":"Reject Appointment Request"}),e.jsx(k,{children:"accept"===z?"Are you sure you want to accept this appointment request? The patient will be notified.":"Please provide a reason for rejecting this appointment request. You can also suggest alternative time slots."})]}),L&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:L.patient.name}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:[new Date(L.date).toLocaleDateString()," at ",L.time]})]}),"reject"===z&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"rejectionReason",children:"Reason for rejection (optional)"}),e.jsx(C,{id:"rejectionReason",placeholder:"e.g., Time slot not available, schedule conflict...",value:B,onChange:e=>J(e.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"alternativeSlots",children:"Alternative time slots (optional)"}),e.jsx(C,{id:"alternativeSlots",placeholder:"e.g., Tomorrow 2:00 PM, Friday 10:00 AM",value:K,onChange:e=>V(e.target.value),className:"mt-1"})]})]})]}),e.jsxs(q,{children:[e.jsx(h,{variant:"outline",onClick:()=>U(!1),disabled:G,children:"Cancel"}),e.jsx(h,{onClick:async()=>{var e;if(L&&z)try{I(!0);const e={action:z};"reject"===z&&(e.rejectionReason=B,K.trim()&&(e.alternativeSlots=K.split(",").map(e=>e.trim())));(await i.patch(`${Q}/appointment-requests/${L.id}/respond`,e,{withCredentials:!0})).data.success&&(n.success(`Appointment request ${z}ed successfully`),await W(),U(!1),$(null),Y(null),J(""),V(""))}catch(s){i.isAxiosError(s)&&s.response?n.error((null==(e=s.response.data)?void 0:e.message)||"Failed to process request"):n.error("Unknown error occurred")}finally{I(!1)}},disabled:G,className:"accept"===z?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:G?"Processing...":"accept"===z?"Accept":"Reject"})]})]})})]})}export{P as default};
