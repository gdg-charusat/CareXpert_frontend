import{j as e}from"./ui-vendor-izRNgCO_.js";import{r as t}from"./react-vendor-r9Et1EnL.js";import{C as s,d as a}from"./card-Sps0XDlE.js";import{e as r,a as l,u as d,S as i,h as c,m as n,U as x,C as o,M as m,F as h,B as j,b as p}from"./index-Dpso9GU3.js";import{I as g}from"./input-Bk6CaQFa.js";import{S as N,a as u,b as y,c as f,d as b}from"./select-BabVgC9Q.js";import"./chart-vendor-D0NPwkge.js";function v(){const[v,w]=t.useState([]),[k,C]=t.useState([]),[E,D]=t.useState(!0),[L,S]=t.useState(""),[T,A]=t.useState("all"),I=r(e=>e.user),R="http://localhost:5000/api";t.useEffect(()=>{"PATIENT"===(null==I?void 0:I.role)&&F()},[I]),t.useEffect(()=>{P()},[v,L,T]);const F=async()=>{var e;try{D(!0);const e=await l.get(`${R}/patient/all-appointments`,{withCredentials:!0});e.data.success&&w(e.data.data)}catch(t){l.isAxiosError(t)&&t.response?d.error((null==(e=t.response.data)?void 0:e.message)||"Failed to fetch appointment history"):d.error("Failed to fetch appointment history")}finally{D(!1)}},P=()=>{let e=[...v];L&&(e=e.filter(e=>e.doctor.name.toLowerCase().includes(L.toLowerCase())||e.doctor.specialty.toLowerCase().includes(L.toLowerCase()))),"all"!==T&&(e=e.filter(e=>e.status===T)),e.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),C(e)},M=t=>{const s={PENDING:{label:"Pending",cls:"bg-gradient-to-r from-amber-400/15 to-yellow-500/15 text-amber-700 dark:text-amber-200 border-amber-400/30"},CONFIRMED:{label:"Confirmed",cls:"bg-gradient-to-r from-emerald-400/15 to-teal-500/15 text-emerald-700 dark:text-emerald-200 border-emerald-400/30"},COMPLETED:{label:"Completed",cls:"bg-gradient-to-r from-sky-400/15 to-indigo-500/15 text-sky-700 dark:text-sky-200 border-sky-400/30"},CANCELLED:{label:"Cancelled",cls:"bg-gradient-to-r from-rose-400/15 to-red-500/15 text-rose-700 dark:text-rose-200 border-rose-400/30"},REJECTED:{label:"Rejected",cls:"bg-gradient-to-r from-rose-400/15 to-red-500/15 text-rose-700 dark:text-rose-200 border-rose-400/30"}},a=s[t]||s.PENDING;return e.jsx(p,{variant:"outline",className:`backdrop-blur-sm rounded-full px-2.5 py-1 border shadow-sm text-xs font-medium ${a.cls}`,children:a.label})},O=e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),$={total:v.length,pending:v.filter(e=>"PENDING"===e.status).length,confirmed:v.filter(e=>"CONFIRMED"===e.status).length,completed:v.filter(e=>"COMPLETED"===e.status).length,cancelled:v.filter(e=>"CANCELLED"===e.status).length,rejected:v.filter(e=>"REJECTED"===e.status).length};return E?e.jsx("div",{className:"p-6 md:p-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})})}):e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Appointment History"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"View your past and upcoming appointments"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:$.total}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:$.pending}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Request Sent"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:$.confirmed}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Confirmed"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:$.completed}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:$.cancelled}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Cancelled"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:$.rejected}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Rejected"})]})})})]}),e.jsx(s,{className:"mb-6",children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(g,{placeholder:"Search by doctor name or specialty...",value:L,onChange:e=>S(e.target.value),className:"pl-10"})]})}),e.jsxs(N,{value:T,onValueChange:A,children:[e.jsx(u,{className:"w-full md:w-48",children:e.jsx(y,{placeholder:"Filter by status"})}),e.jsxs(f,{children:[e.jsx(b,{value:"all",children:"All Statuses"}),e.jsx(b,{value:"PENDING",children:"Request Sent"}),e.jsx(b,{value:"CONFIRMED",children:"Confirmed"}),e.jsx(b,{value:"COMPLETED",children:"Completed"}),e.jsx(b,{value:"CANCELLED",children:"Cancelled"}),e.jsx(b,{value:"REJECTED",children:"Rejected"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:0===k.length?e.jsx(s,{children:e.jsxs(a,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(c,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No appointments found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:0===v.length?"You don't have any appointments yet.":"No appointments match your current filters."})]})}):k.map(t=>{return e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(s,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx(x,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:t.doctor.name}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:t.doctor.specialty})]})]}),e.jsxs("div",{className:"text-right",children:[M(t.status),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Created: ",O(t.createdAt)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:O(t.date)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:(r=t.time,new Date(`2000-01-01T${r}`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.doctor.clinicLocation})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.appointmentType})]})]}),t.notes&&e.jsx("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Notes:"})," ",t.notes]})}),t.consultationFee&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Consultation Fee:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["â‚¹",t.consultationFee]})]}),t.prescriptionId&&e.jsx("div",{className:"mt-4",children:e.jsx(j,{variant:"secondary",onClick:()=>window.open(`${R}/patient/prescription-pdf/${t.prescriptionId}`,"_blank"),children:"View Prescription"})})]})})},t.id);var r})})]})}export{v as default};
