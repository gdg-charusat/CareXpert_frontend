import{j as e}from"./ui-vendor-izRNgCO_.js";import{r as s}from"./react-vendor-r9Et1EnL.js";import{c as a,d as t,e as l,u as r,S as n,B as i,M as c,b as o,C as d,H as m,A as x,f as h,g as p,U as u,a as j}from"./index-Dpso9GU3.js";import{I as g}from"./input-Bk6CaQFa.js";import{C as N,d as f}from"./card-Sps0XDlE.js";import{S as v,a as y,b,c as w,d as S}from"./select-BabVgC9Q.js";import{T as k}from"./textarea-Bh8QdlON.js";import{L as C}from"./label-BnKDd-HG.js";import{D as A,a as F,b as I,c as L,d as E}from"./dialog-CzuAHObH.js";import{V as O}from"./video-DMlmEuFZ.js";import"./chart-vendor-D0NPwkge.js";
/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=a("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function D({src:a,alt:l,fallback:r="/placeholder.png",className:n,containerClassName:i,showLoader:c=!0,...o}){const[d,m]=s.useState(r),[x,h]=s.useState(!0),[p,u]=s.useState(!1);return s.useEffect(()=>{const e=new Image;return e.src=a,e.onload=()=>{m(a),h(!1)},e.onerror=()=>{u(!0),h(!1),m(r)},()=>{e.onload=null,e.onerror=null}},[a,r]),e.jsxs("div",{className:t("relative overflow-hidden",i),children:[x&&c&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted animate-pulse",children:e.jsx("div",{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin"})}),e.jsx("img",{src:d,alt:l,loading:"lazy",className:t("transition-opacity duration-300",x?"opacity-0":"opacity-100",n),...o}),p&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted text-muted-foreground text-xs",children:"Failed to load"})]})}function M({src:s,alt:a,className:l,fallback:r="/default-avatar.png"}){return e.jsx(D,{src:s||r,alt:a,fallback:r,className:t("rounded-full object-cover",l),containerClassName:"rounded-full"})}function P({className:s,...a}){return e.jsx("div",{className:t("animate-pulse rounded-md bg-muted",s),...a})}function $(){return e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(P,{className:"h-16 w-16 rounded-full"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(P,{className:"h-4 w-3/4"}),e.jsx(P,{className:"h-3 w-1/2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"h-3 w-full"}),e.jsx(P,{className:"h-3 w-4/5"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{className:"h-8 w-20"}),e.jsx(P,{className:"h-8 w-20"})]})]})}const B=new class{getStorage(e){return"local"===e?localStorage:sessionStorage}set(e,s,a={}){const{ttl:t,storage:l="local"}=a,r={data:s,timestamp:Date.now(),ttl:t};try{this.getStorage(l).setItem(e,JSON.stringify(r))}catch(n){}}get(e,s="local"){try{const a=this.getStorage(s).getItem(e);if(!a)return null;const t=JSON.parse(a);if(t.ttl){if(Date.now()-t.timestamp>t.ttl)return this.remove(e,s),null}return t.data}catch(a){return null}}remove(e,s="local"){try{this.getStorage(s).removeItem(e)}catch(a){}}clear(e="local"){try{this.getStorage(e).clear()}catch(s){}}async getOrFetch(e,s,a={}){const t=this.get(e,a.storage);if(null!==t)return t;const l=await s();return this.set(e,l,a),l}},V="doctors_list",G={SHORT:3e5,MEDIUM:9e5,LONG:36e5,VERY_LONG:864e5};function Y(){const[a,t]=s.useState(""),[D,P]=s.useState("all"),[Y,U]=s.useState("all"),[_,H]=s.useState([]),[J,R]=s.useState(!1),q=function(e,a=400){const[t,l]=s.useState(e);return s.useEffect(()=>{const s=setTimeout(()=>{l(e)},a);return()=>{clearTimeout(s)}},[e,a]),t}(a,400),[z,W]=s.useState(!1),[K,Q]=s.useState(null),[X,Z]=s.useState({doctorId:"",date:"",time:"",appointmentType:"OFFLINE",notes:""}),[ee,se]=s.useState(!1),ae=l(e=>e.user),te="http://localhost:5000/api/patient";s.useEffect(()=>{(async()=>{var e;try{R(!0);const e=`${V}_${q}`,s=B.get(e);if(s)return H(s),void R(!1);const a=await j.get(`${te}/fetchAllDoctors`,{params:{search:q},withCredentials:!0});a.data.success&&(H(a.data.data),B.set(e,a.data.data,{ttl:G.MEDIUM,storage:"session"}))}catch(s){j.isAxiosError(s)&&s.response?r.error((null==(e=s.response.data)?void 0:e.message)||"Something went wrong"):r.error("An unexpected error occurred.")}finally{R(!1)}})()},[q,te]);const le=s.useMemo(()=>_.filter(e=>{const s="all"===D||e.specialty===D,a="all"===Y||e.clinicLocation===Y;return s&&a}),[_,D,Y]),re=s.useCallback(e=>{ae&&"PATIENT"===ae.role?(Q(e),Z({doctorId:e.id,date:"",time:"",appointmentType:"OFFLINE",notes:""}),W(!0)):r.error("Please login as a patient to book appointments")},[ae]),ne=s.useCallback(()=>{W(!1),Q(null),Z({doctorId:"",date:"",time:"",appointmentType:"OFFLINE",notes:""})},[]),ie=s.useMemo(()=>{const e=[];for(let s=9;s<=17;s++)for(let a=0;a<60;a+=30){const t=`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`;e.push(t)}return e},[]);return e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Find Your Doctor"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:"Connect with certified healthcare professionals and book appointments with ease"})]}),e.jsx(N,{className:"mb-8",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(g,{placeholder:"Search doctors or specialties...",value:a,onChange:e=>t(e.target.value),className:"pl-10"})]}),e.jsxs(v,{value:D,onValueChange:P,children:[e.jsx(y,{children:e.jsx(b,{placeholder:"All Specialties"})}),e.jsxs(w,{children:[e.jsx(S,{value:"all",children:"All Specialties"}),["Cardiology","Dermatology","General Medicine","Neurology","Pediatrics","Psychiatry","Orthopedics","Gynecology"].map(s=>e.jsx(S,{value:s,children:s},s))]})]}),e.jsxs(v,{value:Y,onValueChange:U,children:[e.jsx(y,{children:e.jsx(b,{placeholder:"All Locations"})}),e.jsxs(w,{children:[e.jsx(S,{value:"all",children:"All Locations"}),["New York, NY","Los Angeles, CA","Chicago, IL","Boston, MA","Miami, FL","Seattle, WA"].map(s=>e.jsx(S,{value:s,children:s},s))]})]}),e.jsxs(i,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Apply Filters"]})]})})}),J?e.jsxs("div",{className:"grid gap-6",children:[e.jsx($,{}),e.jsx($,{}),e.jsx($,{})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["Showing ",le.length," doctors"]})}),e.jsx("div",{className:"grid gap-6",children:le.map(s=>e.jsx(N,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"grid lg:grid-cols-12 gap-6 items-start",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(M,{src:s.user.profilePicture,alt:s.user.name,className:"h-20 w-20 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white truncate",children:s.user.name})}),e.jsx("p",{className:"text-blue-600 dark:text-blue-400 font-medium mb-2",children:s.specialty}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-300 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.clinicLocation})]}),e.jsxs("span",{className:"whitespace-nowrap",children:[s.experience," experience"]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-3 line-clamp-2",children:s.bio}),e.jsxs("div",{className:"flex flex-col gap-2",children:[s.education&&e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx(o,{variant:"outline",className:"text-xs",children:s.education})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.languages.map(s=>e.jsx(o,{variant:"outline",className:"text-xs",children:s},s))})]})]})]})}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",s.consultationFee||" 0 "]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Consultation fee"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-600 dark:text-gray-300 mb-4",children:[e.jsx(d,{className:"h-4 w-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:"Available for booking"})]}),e.jsxs(i,{className:"w-full",onClick:()=>re(s),children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),"Book Appointment"]})]})})]})})},s.id))})]})]}),e.jsx(A,{open:z,onOpenChange:W,children:e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsx(I,{children:e.jsx(L,{children:"Book Appointment"})}),K&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs(x,{className:"h-12 w-12",children:[e.jsx(h,{src:K.user.profilePicture||"/placeholder.svg"}),e.jsx(p,{children:K.user.name.split(" ").map(e=>e[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:K.user.name}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:K.specialty}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["$",K.consultationFee," consultation fee"]})]})]}),e.jsxs("form",{onSubmit:async e=>{var s;if(e.preventDefault(),X.date&&X.time){se(!0);try{(await j.post(`${te}/book-direct-appointment`,X,{withCredentials:!0})).data.success&&(r.success("Appointment booked successfully!"),ne())}catch(a){j.isAxiosError(a)&&a.response?r.error((null==(s=a.response.data)?void 0:s.message)||"Failed to ppiunppointment"):r.error("An unexpected error occurred")}finally{se(!1)}}else r.error("Please select both date and time")},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"date",children:"Date"}),e.jsx(g,{id:"date",type:"date",value:X.date,onChange:e=>Z(s=>({...s,date:e.target.value})),min:(new Date).toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"time",children:"Time"}),e.jsxs(v,{value:X.time,onValueChange:e=>Z(s=>({...s,time:e})),children:[e.jsx(y,{children:e.jsx(b,{placeholder:"Select time"})}),e.jsx(w,{children:ie.map(s=>e.jsx(S,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"appointmentType",children:"Appointment Type"}),e.jsxs(v,{value:X.appointmentType,onValueChange:e=>Z(s=>({...s,appointmentType:e})),children:[e.jsx(y,{children:e.jsx(b,{})}),e.jsxs(w,{children:[e.jsx(S,{value:"OFFLINE",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),"In-Person"]})}),e.jsx(S,{value:"ONLINE",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Video Call"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(k,{id:"notes",placeholder:"Any specific concerns or symptoms you'd like to discuss...",value:X.notes,onChange:e=>Z(s=>({...s,notes:e.target.value})),rows:3})]}),e.jsxs(E,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:ne,children:"Cancel"}),e.jsx(i,{type:"submit",disabled:ee,children:ee?"Booking...":"Book Appointment"})]})]})]})]})})]})}export{Y as default};
