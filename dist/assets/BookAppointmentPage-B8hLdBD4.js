import{j as e}from"./ui-vendor-izRNgCO_.js";import{h as s,d as a,r as t}from"./react-vendor-r9Et1EnL.js";import{e as r,N as i,A as n,f as l,g as c,M as d,C as o,b as m,U as x,B as h,a as p,u as j}from"./index-Dpso9GU3.js";import{F as u}from"./footer-Bnls4Kf-.js";import{I as g}from"./input-Bk6CaQFa.js";import{L as N}from"./label-BnKDd-HG.js";import{C as f,a as v,b as y,d as b,c as w}from"./card-Sps0XDlE.js";import{S,a as A,b as F,c as k,d as C}from"./select-BabVgC9Q.js";import{T}from"./textarea-Bh8QdlON.js";import{S as D}from"./star-BfAUwXlL.js";import{V as E}from"./video-DMlmEuFZ.js";import"./chart-vendor-D0NPwkge.js";function I(){const{id:I}=s(),L=a(),q=r(e=>e.user),[O,$]=t.useState(null),[P,V]=t.useState(!0),[B,R]=t.useState(!1),[z,M]=t.useState({doctorId:I||"",date:"",time:"",appointmentType:"OFFLINE",notes:""}),U="http://localhost:5000/api/patient";t.useEffect(()=>{if(!q||"PATIENT"!==q.role)return void L("/auth/login");I&&(async()=>{var e;try{const e=await p.get(`${U}/fetchAllDoctors`,{withCredentials:!0});if(e.data.success){const s=e.data.data;s&&s.id===I?$(s):(j.error("Doctor not found"),L("/doctors"))}}catch(s){p.isAxiosError(s)&&s.response?j.error((null==(e=s.response.data)?void 0:e.message)||"Failed to fetch doctor details"):j.error("An unexpected error occurred"),L("/doctors")}finally{V(!1)}})()},[I,q,L,U]);const Y=(e,s)=>{M(a=>({...a,[e]:s}))};return P?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(i,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-lg",children:"Loading doctor details..."})})}),e.jsx(u,{})]}):O?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(i,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Book an Appointment"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["Schedule your consultation with ",O.user.name]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-3",children:[e.jsxs(n,{className:"h-12 w-12",children:[e.jsx(l,{src:O.user.profilePicture||"/placeholder.svg"}),e.jsx(c,{children:O.user.name.split(" ").map(e=>e[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:O.user.name}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:O.specialty})]})]})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(d,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:O.clinicLocation})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(o,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{children:[O.experience," experience"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{children:["$",O.consultationFee," consultation fee"]})]}),O.education&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Education:"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:O.education})]}),O.bio&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"About:"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:O.bio})]}),O.languages.length>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium mb-2",children:"Languages:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:O.languages.map(s=>e.jsx(m,{variant:"outline",className:"text-xs",children:s},s))})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(y,{children:"Appointment Details"}),e.jsx(w,{children:"Fill in the details to send an appointment request to the doctor"})]}),e.jsx(b,{children:e.jsxs("form",{onSubmit:async e=>{var s;if(e.preventDefault(),z.date&&z.time){R(!0);try{(await p.post(`${U}/book-direct-appointment`,z,{withCredentials:!0})).data.success&&(j.success("Appointment request sent successfully! You will be notified once the doctor responds."),L("/dashboard/patient"))}catch(a){p.isAxiosError(a)&&a.response?j.error((null==(s=a.response.data)?void 0:s.message)||"Failed to book appointment"):j.error("An unexpected error occurred")}finally{R(!1)}}else j.error("Please select both date and time")},className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"date",children:"Date"}),e.jsx(g,{id:"date",type:"date",value:z.date,onChange:e=>Y("date",e.target.value),min:(new Date).toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"time",children:"Time"}),e.jsxs(S,{value:z.time,onValueChange:e=>Y("time",e),children:[e.jsx(A,{children:e.jsx(F,{placeholder:"Select time"})}),e.jsx(k,{children:(()=>{const e=[];for(let s=9;s<=17;s++)for(let a=0;a<60;a+=30){const t=`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`;e.push(t)}return e})().map(s=>e.jsx(C,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"appointmentType",children:"Appointment Type"}),e.jsxs(S,{value:z.appointmentType,onValueChange:e=>Y("appointmentType",e),children:[e.jsx(A,{children:e.jsx(F,{})}),e.jsxs(k,{children:[e.jsx(C,{value:"OFFLINE",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"In-Person"]})}),e.jsx(C,{value:"ONLINE",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Video Call"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(T,{id:"notes",placeholder:"Any specific concerns or symptoms you'd like to discuss...",value:z.notes,onChange:e=>Y("notes",e.target.value),rows:4})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>L("/doctors"),className:"flex-1",children:"Cancel"}),e.jsx(h,{type:"submit",disabled:B,className:"flex-1",children:B?"Sending Request...":"Send Appointment Request"})]})]})})]})})]})]})}),e.jsx(u,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(i,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-lg text-red-600",children:"Doctor not found"})})}),e.jsx(u,{})]})}export{I as default};
