import{j as e}from"./ui-vendor-izRNgCO_.js";import{r as t}from"./react-vendor-r9Et1EnL.js";import{C as s,d as a}from"./card-Sps0XDlE.js";import{e as l,a as r,u as i,S as n,h as c,m as d,A as x,f as o,g as m,C as h,F as j,b as g}from"./index-Dpso9GU3.js";import{I as p}from"./input-Bk6CaQFa.js";import{S as u,a as N,b as y,c as v,d as f}from"./select-BabVgC9Q.js";import{M as b}from"./mail-BO1CeZ5_.js";import"./chart-vendor-D0NPwkge.js";function w(){const[w,C]=t.useState([]),[D,E]=t.useState([]),[k,S]=t.useState(!0),[T,L]=t.useState(""),[M,A]=t.useState("all"),[F,P]=t.useState("all"),R=l(e=>e.user);t.useEffect(()=>{"DOCTOR"===(null==R?void 0:R.role)&&I()},[R]),t.useEffect(()=>{O()},[w,T,M,F]);const I=async()=>{var e;try{S(!0);const e=await r.get("http://localhost:5000/api/doctor/all-appointments",{withCredentials:!0});e.data.success&&C(e.data.data)}catch(t){r.isAxiosError(t)&&t.response?i.error((null==(e=t.response.data)?void 0:e.message)||"Failed to fetch appointment history"):i.error("Failed to fetch appointment history")}finally{S(!1)}},O=()=>{let e=[...w];if(T&&(e=e.filter(e=>e.patient.name.toLowerCase().includes(T.toLowerCase())||e.patient.email.toLowerCase().includes(T.toLowerCase()))),"all"!==M&&(e=e.filter(e=>e.status===M)),"all"!==F){const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),t.getDate());e=e.filter(e=>{const a=new Date(e.date);switch(F){case"today":return a.toDateString()===s.toDateString();case"thisWeek":const e=new Date(s);e.setDate(s.getDate()-s.getDay());const l=new Date(e);return l.setDate(e.getDate()+6),a>=e&&a<=l;case"thisMonth":return a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear();case"past":return a<s;case"upcoming":return a>=s;default:return!0}})}e.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),E(e)},G=t=>{const s={PENDING:{variant:"secondary",label:"Pending",color:"text-yellow-600"},CONFIRMED:{variant:"default",label:"Confirmed",color:"text-green-600"},COMPLETED:{variant:"default",label:"Completed",color:"text-blue-600"},CANCELLED:{variant:"destructive",label:"Cancelled",color:"text-red-600"},REJECTED:{variant:"destructive",label:"Rejected",color:"text-red-600"}},a=s[t]||s.PENDING;return e.jsx(g,{variant:a.variant,className:a.color,children:a.label})},H=e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),Y={total:w.length,pending:w.filter(e=>"PENDING"===e.status).length,confirmed:w.filter(e=>"CONFIRMED"===e.status).length,completed:w.filter(e=>"COMPLETED"===e.status).length,cancelled:w.filter(e=>"CANCELLED"===e.status).length,rejected:w.filter(e=>"REJECTED"===e.status).length};return k?e.jsx("div",{className:"p-6 md:p-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})})}):e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Appointment History"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"View and manage your appointment history"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:Y.total}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Y.pending}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pending"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Y.confirmed}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Confirmed"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Y.completed}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:Y.cancelled}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Cancelled"})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:Y.rejected}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Rejected"})]})})})]}),e.jsx(s,{className:"mb-6",children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(p,{placeholder:"Search by patient name or email...",value:T,onChange:e=>L(e.target.value),className:"pl-10"})]})}),e.jsxs(u,{value:M,onValueChange:A,children:[e.jsx(N,{className:"w-full md:w-48",children:e.jsx(y,{placeholder:"Filter by status"})}),e.jsxs(v,{children:[e.jsx(f,{value:"all",children:"All Statuses"}),e.jsx(f,{value:"PENDING",children:"Pending"}),e.jsx(f,{value:"CONFIRMED",children:"Confirmed"}),e.jsx(f,{value:"COMPLETED",children:"Completed"}),e.jsx(f,{value:"CANCELLED",children:"Cancelled"}),e.jsx(f,{value:"REJECTED",children:"Rejected"})]})]}),e.jsxs(u,{value:F,onValueChange:P,children:[e.jsx(N,{className:"w-full md:w-48",children:e.jsx(y,{placeholder:"Filter by date"})}),e.jsxs(v,{children:[e.jsx(f,{value:"all",children:"All Dates"}),e.jsx(f,{value:"today",children:"Today"}),e.jsx(f,{value:"thisWeek",children:"This Week"}),e.jsx(f,{value:"thisMonth",children:"This Month"}),e.jsx(f,{value:"past",children:"Past"}),e.jsx(f,{value:"upcoming",children:"Upcoming"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:0===D.length?e.jsx(s,{children:e.jsxs(a,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(c,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No appointments found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:0===w.length?"You don't have any appointments yet.":"No appointments match your current filters."})]})}):D.map(t=>{return e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(s,{children:e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(x,{className:"h-12 w-12",children:[e.jsx(o,{src:t.patient.profilePicture}),e.jsx(m,{children:t.patient.name.charAt(0)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:t.patient.name}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:t.patient.email})]})]})]}),e.jsxs("div",{className:"text-right",children:[G(t.status),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Created: ",H(t.createdAt)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:H(t.date)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:(l=t.time,new Date(`2000-01-01T${l}`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.appointmentType})]}),t.consultationFee&&e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["â‚¹",t.consultationFee]})})]}),t.notes&&e.jsx("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Notes:"})," ",t.notes]})}),t.patient.medicalHistory&&e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Medical History:"})," ",t.patient.medicalHistory]})})]})})},t.id);var l})})]})}export{w as default};
